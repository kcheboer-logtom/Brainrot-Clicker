<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Clicker Game</title>
  <style>
    :root{
      --bg:#0f1220; --panel:#151935; --muted:#8a93b2; --text:#e8ecff;
      --accent:#7c5cff; --accent-2:#34d399; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Helvetica,Arial,sans-serif;
      background:
        radial-gradient(1200px 800px at 80% -10%, #1b2050 0%, transparent 60%),
        radial-gradient(600px 600px at -10% 110%, #21386b 0%, transparent 60%),
        var(--bg);
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
    }

    .app{
      position:relative;
      width:min(980px,100%);
      display:grid;
      grid-template-columns: 1.2fr 1fr;
      gap:16px;
      align-items:start;
    }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border:1px solid rgba(255,255,255,0.08);
      border-radius:20px;
      padding:20px;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }

    h1{margin:0 0 10px; font-weight:800; letter-spacing:.2px}
    .money{font-size: clamp(28px, 5vw, 44px); font-weight:800;}
    .sub{color:var(--muted); font-size:14px}

    /* main click area */
    .big-btn{
      width:100%;
      max-height:260px;
      border:none;
      border-radius:18px;
      font-size: clamp(28px, 4vw, 38px);
      font-weight:900;
      cursor:pointer;
      margin-top:16px;
      color:#0b0820;
      background: none;
      transition: transform .05s ease, filter .2s ease;
      box-shadow:0 12px 30px rgba(124,92,255,.35);
      padding:0;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      z-index:1;
    }
    .big-btn img{
      max-width:100%;
      max-height:100%;
      height:auto;
      width:auto;
      object-fit:contain;
      border-radius:18px;
      display:block;
    }
    .big-btn:active{ transform: translateY(2px) scale(.99); filter:brightness(.95) }

    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .stat{background:rgba(255,255,255,.06); padding:10px 12px; border-radius:12px; font-size:14px}

    /* shop */
    .shop {
      display:flex;
      flex-direction:column;
      max-height:460px; /* control visible height */
      overflow-y:auto;
      padding-right:8px;
    }
    .shop h2{margin:0 0 10px; position:sticky; top:0; background:transparent; padding-bottom:6px}
    .item{
      display:flex; gap:12px; align-items:center; justify-content:space-between;
      padding:12px; border-radius:14px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.08);
      margin-bottom:10px;
    }
    .item .meta{display:flex; flex-direction:column; gap:4px}
    .item .name{font-weight:700}
    .item .desc{font-size:13px; color:var(--muted)}
    .item button{border:none; padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer; color:#0b0820;
                 background:linear-gradient(180deg, #a78bfa, #7c5cff);}
    .item button[disabled]{opacity:.5; cursor:not-allowed; filter:grayscale(.2)}

    /* scrollbar */
    .shop::-webkit-scrollbar { width:8px }
    .shop::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.12); border-radius:6px }
    .shop::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2) }

    /* golden bonus image (small) */
    #goldenImg {
      position:absolute;
      width:88px;
      height:88px;
      cursor:pointer;
      z-index:50;
      display:none;
      border-radius:8px;
      box-shadow: 0 8px 20px rgba(255,200,60,0.12), 0 3px 6px rgba(0,0,0,0.45);
      transform-origin:center center;
    }

    @media (max-width: 880px){
      .app{grid-template-columns: 1fr;}
      .big-btn{max-height:180px}
    }
  </style>
</head>
<body>
  <div class="app" id="app">
    <!-- golden image element (positioned absolutely inside .app) -->
    <img id="goldenImg" src="goldb.png" alt="Gold Bonus">

    <section class="card">
      <h1>Brainrot Clicker Game</h1>
      <div class="row">
        <div class="money" id="money">$0</div>
        <div class="stat" id="perClick">Per Click: $1</div>
        <div class="stat" id="autoRate">Auto: 0 / sec</div>
      </div>

      <button class="big-btn" id="clickBtn" aria-label="Click to earn">
        <img id="mainImg" src="tralala.jpeg" alt="Click Image">
      </button>

      <div class="row" style="margin-top:12px">
        <div class="hint">  <b></b>  <b></b> Made by Kcheboer.</div>
      </div>

      <div class="row" style="margin-top:14px">
        <div class="toolbar">
          <button class="ghost" id="saveBtn">Save</button>
          <button class="ghost" id="resetBtn">Hard Reset</button>
        </div>
      </div>
    </section>

    <section class="card shop" id="shop">
      <h2>Upgrades</h2>

      <!-- Upgrades list (populated by JS) -->
      <div id="upgradesList"></div>

    </section>
  </div>
  <script>
    // ---------- utilities ----------
    const fmt = new Intl.NumberFormat();
    const $ = (id) => document.getElementById(id);

    // try multiple extensions for an image base (so goldb.png or goldb.jpeg etc. both work)
    function trySetImage(imgEl, baseName) {
      const exts = ['png','jpeg','jpg','webp','gif'];
      let set = false;
      exts.forEach(ext => {
        const candidate = `${baseName}.${ext}`;
        const test = new Image();
        test.onload = () => { if(!set){ imgEl.src = candidate; set = true; } };
        test.onerror = ()=>{};
        test.src = candidate;
      });
    }

    // ---------- state ----------
    const defaultState = {
      money: 0,
      perClick: 1,
      multCost: 50,

      autoRate: 0,
      autoCost: 100,

      tickMs: 1000,
      tickCost: 250,

      // counts/costs for named upgrades
      tungOwned: 0, tungCost: 500,
      factoryOwned: 0, factoryCost: 2000,
      orcaOwned: 0, orcaCost: 20000,

      gemOwned: 0, gemCost: 10000,      // Brr Brr Patapim Gem (click)
      planetOwned: 0, planetCost: 500000, // La Vaca Saturno Planet (click)
      udinOwned: 0, udinCost: 750000,   // Udin Din Din Dun Muscle (click)

      // trenostruzzo: turbo tick purchases
      trenOwned: 0, trenCost: 250,

      lastSave: Date.now()
    };

    let S = (function load(){ try{ const raw = localStorage.getItem('clicker-save'); return raw ? JSON.parse(raw) : null; }catch(e){ return null; } })() || {...defaultState};

    // ---------- DOM refs ----------
    const moneyEl = $('money');
    const perClickEl = $('perClick');
    const autoRateEl = $('autoRate');
    const clickBtn = $('clickBtn');
    const mainImg = $('mainImg');
    const shopEl = $('shop');
    const upgradesList = $('upgradesList');
    const goldenImg = $('goldenImg');

    // try to be tolerant about image filenames
    trySetImage(mainImg, 'tralala');
    trySetImage(goldenImg, 'goldb');

    // milestones for main image swapping (optional images you can place in same folder)
    const milestones = [
      {value:500, imageBase:'tralala1'},
      {value:1000,imageBase:'tralala2'},
      {value:10000,imageBase:'tralala3'},
      {value:250000,imageBase:'tralala4'},
      {value:1000000,imageBase:'tralala5'},
      {value:5000000,imageBase:'tralala6'},
      {value:30000000,imageBase:'tralala7'},
      {value:100000000,imageBase:'tralala8'}
    ];
    let currentImageBase = 'tralala';

    function checkMilestones(){
      for(let i=milestones.length-1;i>=0;i--){
        if(S.money >= milestones[i].value){
          if(currentImageBase !== milestones[i].imageBase){
            currentImageBase = milestones[i].imageBase;
            trySetImage(mainImg, currentImageBase);
          }
          return;
        }
      }
      // fallback default
      if(currentImageBase !== 'tralala'){ currentImageBase = 'tralala'; trySetImage(mainImg, 'tralala'); }
    }

    // ---------- upgrade definitions ----------
    // Note: type: 'click' increases perClick, 'auto' increases autoRate, 'other' uses a special function
    const UPGRADE_DEFS = [
      { id:'click1', name:'Click Power +1', desc:'Increase money per click. Cost scales ×1.5', type:'click', costKey:'multCost', baseCost:50, power:1 },
      { id:'gem', name:'Brr Brr Patapim Gem', desc:'Big click boost.', type:'click', costKey:'gemCost', baseCost:10000, power:50 },
      { id:'planet', name:'La Vaca Saturno Saturnita Planet', desc:'Huge click boost.', type:'click', costKey:'planetCost', baseCost:500000, power:500 },
      { id:'udin', name:'Udin Din Din Dun Muscle', desc:'Massive click power.', type:'click', costKey:'udinCost', baseCost:750000, power:2000 },

      { id:'autoc', name:'AutoClicker +1/sec', desc:'Generates money automatically. Cost scales ×1.7', type:'auto', costKey:'autoCost', baseCost:100, power:1 },
      { id:'tung', name:'Tung Worker', desc:'+1 / sec worker. Cost scales ×1.7', type:'auto', costKey:'tungCost', baseCost:500, power:1 },
      { id:'factory', name:'Tralelo Factory', desc:'+10 / sec factory. Cost scales ×1.7', type:'auto', costKey:'factoryCost', baseCost:2000, power:10 },
      { id:'orca', name:'Orca Miner', desc:'+100 / sec miner. Cost scales ×1.7', type:'auto', costKey:'orcaCost', baseCost:20000, power:100 },

      { id:'tren', name:'Trenostruzzo Turbo Tick', desc:'Improve auto tick rate by 10% each purchase (min 50ms)', type:'tren', costKey:'trenCost', baseCost:250, power:0 }
    ];

    // ---------- helper functions ----------
    function format(n){ return `$${fmt.format(Math.floor(n))}`; }

    function save(){
      try{ localStorage.setItem('clicker-save', JSON.stringify(S)); S.lastSave = Date.now(); }catch(e){}
    }

    function applyTickIncome(amount){
      // can add interest or other multiplicative bonuses later
      return amount;
    }

    // ---------- UI rendering ----------
    function renderUpgrades(){
      upgradesList.innerHTML = '';
      UPGRADE_DEFS.forEach(def => {
        const container = document.createElement('div');
        container.className = 'item';
        const meta = document.createElement('div');
        meta.className = 'meta';
        const name = document.createElement('div');
        name.className = 'name';
        name.textContent = def.name;
        const desc = document.createElement('div');
        desc.className = 'desc';
        desc.textContent = def.desc;
        const hint = document.createElement('div');
        hint.className = 'hint';
        // determine owned / level and cost from S
        let owned, cost;
        switch(def.id){
          case 'click1': owned = S.multLevel || 0; cost = S.multCost; break;
          case 'gem': owned = S.gemOwned || 0; cost = S.gemCost; break;
          case 'planet': owned = S.planetOwned || 0; cost = S.planetCost; break;
          case 'udin': owned = S.udinOwned || 0; cost = S.udinCost; break;

          case 'autoc': owned = S.autoLevel || 0; cost = S.autoCost; break;
          case 'tung': owned = S.tungOwned || 0; cost = S.tungCost; break;
          case 'factory': owned = S.factoryOwned || 0; cost = S.factoryCost; break;
          case 'orca': owned = S.orcaOwned || 0; cost = S.orcaCost; break;

          case 'tren': owned = S.trenOwned || 0; cost = S.trenCost; break;
          default: owned = 0; cost = def.baseCost;
        }
        hint.textContent = (def.type === 'click') ? `Level ${owned}` : `Owned ${owned}`;
        meta.appendChild(name);
        meta.appendChild(desc);
        meta.appendChild(hint);

        const right = document.createElement('div');
        right.style.display = 'flex';
        right.style.flexDirection = 'column';
        right.style.alignItems = 'flex-end';
        const btn = document.createElement('button');
        btn.textContent = `Buy — ${format(cost)}`;
        btn.disabled = S.money < cost;
        btn.onclick = ()=> buyUpgrade(def.id);
        right.appendChild(btn);
        const small = document.createElement('div');
        small.style.fontSize='12px';
        small.style.color='var(--muted)';
        small.textContent = (def.type === 'click' ? `${def.power} click` : (def.type==='auto' ? `${def.power} cps` : ''));
        right.appendChild(small);

        container.appendChild(meta);
        container.appendChild(right);
        upgradesList.appendChild(container);
      });
    }

    function updateUI(){
      moneyEl.textContent = format(S.money);
      perClickEl.textContent = `Per Click: ${format(S.perClick)}`;
      autoRateEl.textContent = `Auto: ${format(S.autoRate)} / sec`;

      renderUpgrades();

      // autosave heartbeat
      if(Date.now() - S.lastSave > 5000) save();
    }

    // ---------- buy logic ----------
    function buyUpgrade(id){
      switch(id){
        case 'click1':
          if(S.money < S.multCost) return;
          S.money -= S.multCost;
          S.perClick += 1;
          S.multLevel = (S.multLevel||0) + 1;
          S.multCost = Math.ceil(S.multCost * 1.5);
          break;

        case 'gem':
          if(S.money < S.gemCost) return;
          S.money -= S.gemCost;
          S.perClick += 50;
          S.gemOwned = (S.gemOwned||0)+1;
          S.gemCost = Math.ceil(S.gemCost * 1.7);
          break;

        case 'planet':
          if(S.money < S.planetCost) return;
          S.money -= S.planetCost;
          S.perClick += 500;
          S.planetOwned = (S.planetOwned||0)+1;
          S.planetCost = Math.ceil(S.planetCost * 1.7);
          break;

        case 'udin':
          if(S.money < S.udinCost) return;
          S.money -= S.udinCost;
          S.perClick += 2000;
          S.udinOwned = (S.udinOwned||0)+1;
          S.udinCost = Math.ceil(S.udinCost * 2.5);
          break;

        case 'autoc':
          if(S.money < S.autoCost) return;
          S.money -= S.autoCost;
          S.autoRate += 1;
          S.autoLevel = (S.autoLevel||0)+1;
          S.autoCost = Math.ceil(S.autoCost * 1.7);
          break;

        case 'tung':
          if(S.money < S.tungCost) return;
          S.money -= S.tungCost;
          S.autoRate += 1;
          S.tungOwned = (S.tungOwned||0)+1;
          S.tungCost = Math.ceil(S.tungCost * 1.7);
          break;

        case 'factory':
          if(S.money < S.factoryCost) return;
          S.money -= S.factoryCost;
          S.autoRate += 10;
          S.factoryOwned = (S.factoryOwned||0)+1;
          S.factoryCost = Math.ceil(S.factoryCost * 1.7);
          break;

        case 'orca':
          if(S.money < S.orcaCost) return;
          S.money -= S.orcaCost;
          S.autoRate += 100;
          S.orcaOwned = (S.orcaOwned||0)+1;
          S.orcaCost = Math.ceil(S.orcaCost * 1.7);
          break;

        case 'tren':
          if(S.money < S.trenCost || S.tickMs <= 50) return;
          S.money -= S.trenCost;
          S.trenOwned = (S.trenOwned||0)+1;
          S.trenCost = Math.ceil(S.trenCost * 1.6);
          S.tickMs = Math.max(50, Math.round(S.tickMs * 0.9));
          restartAutoLoop();
          break;
      }
      updateUI();
    }

    // ---------- clicking ----------
    clickBtn.addEventListener('click', ()=>{
      S.money += S.perClick;
      checkMilestones();
      updateUI();
    });
    document.addEventListener('keydown', (e)=>{
      if(e.code === 'Spae' || e.code === 'Enteer'){ e.preventDefault(); S.money += S.perClick; checkMilestones(); updateUI(); }
    });

    // ---------- auto income loop ----------
    let autoTimer = null;
    function autoLoop(){
      const delta = S.tickMs / 1000;
      const add = S.autoRate * delta;
      if(add > 0){
        S.money += applyTickIncome(add);
        checkMilestones();
        updateUI();
      }
      autoTimer = setTimeout(autoLoop, S.tickMs);
    }
    function restartAutoLoop(){ if(autoTimer) clearTimeout(autoTimer); autoTimer = setTimeout(autoLoop, S.tickMs); }

    // ---------- save/load/hardreset ----------
    function hardReset(){
      if(!confirm('This will erase your progress. Continue?')) return;
      S = {...defaultState};
      save();
      updateUI();
      restartAutoLoop();
    }
    $('saveBtn').addEventListener('click', ()=>{ save(); alert('Saved'); });
    $('resetBtn').addEventListener('click', hardReset);

    // ---------- Golden bonus: spawn logic w/ collision avoidance ----------
    let goldActive = false;
    let goldTimeout = null;
    const GOLD_SPAWN_CHANCE = 0.15; // 15%
    const GOLD_CHECK_INTERVAL = 60000; // 60s
    const GOLD_TTL = 10000; // 10s

    function rectsOverlap(a,b){
      return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
    }

    function spawnGolden(){
      if(goldActive) return;
      if(Math.random() >= GOLD_SPAWN_CHANCE) return;
      const appRect = $('app').getBoundingClientRect();
      const clickRect = clickBtn.getBoundingClientRect();
      const shopRect = shopEl.getBoundingClientRect();

      // attempt random positions inside app bounds (avoid overlapping clickBtn and shop)
      const maxAttempts = 60;
      let placed = false;
      for(let i=0;i<maxAttempts;i++){
        const size = 88; // golden image size in CSS
        const x = Math.round(Math.random() * (appRect.width - size)) + appRect.left;
        const y = Math.round(Math.random() * (appRect.height - size)) + appRect.top;
        const candidateRect = { left: x, top: y, right: x + size, bottom: y + size };
        // ensure candidateRect inside appRect
        if(candidateRect.left < appRect.left || candidateRect.top < appRect.top ||
           candidateRect.right > appRect.right || candidateRect.bottom > appRect.bottom) continue;
        // avoid clickRect and shopRect
        if(rectsOverlap(candidateRect, clickRect)) continue;
        if(rectsOverlap(candidateRect, shopRect)) continue;
        // position relative to app container
        goldenImg.style.left = (candidateRect.left - appRect.left) + 'px';
        goldenImg.style.top = (candidateRect.top - appRect.top) + 'px';
        placed = true;
        break;
      }
      if(!placed){
        // fallback: try corners that are safe (top-left/top-right/bottom-left/bottom-right)
        const corners = [
          {x: appRect.left + 10, y: appRect.top + 10},
          {x: appRect.right - 98, y: appRect.top + 10},
          {x: appRect.left + 10, y: appRect.bottom - 98},
          {x: appRect.right - 98, y: appRect.bottom - 98}
        ];
        for(const c of corners){
          const candidateRect = { left: c.x, top: c.y, right: c.x+88, bottom: c.y+88 };
          if(rectsOverlap(candidateRect, clickRect)) continue;
          if(rectsOverlap(candidateRect, shopRect)) continue;
          goldenImg.style.left = (c.x - appRect.left) + 'px';
          goldenImg.style.top = (c.y - appRect.top) + 'px';
          placed = true;
          break;
        }
      }

      if(placed){
        goldActive = true;
        goldenImg.style.display = 'block';
        goldenImg.style.transform = 'scale(0.9)';
        // pop animation
        requestAnimationFrame(()=> goldenImg.style.transform = 'scale(1)');
        // auto-disable after TTL
        goldTimeout = setTimeout(()=> { removeGold(); }, GOLD_TTL);
      }
    }

    function removeGold(){
      goldActive = false;
      goldenImg.style.display = 'none';
      if(goldTimeout){ clearTimeout(goldTimeout); goldTimeout = null; }
    }

    goldenImg.addEventListener('click', ()=>{
      if(!goldActive) return;
      // reward = +30% of current money (rounded)
      const reward = Math.floor(S.money * 0.3);
      if(reward > 0) S.money += reward;
      removeGold();
      updateUI();
    });

    // timer to check every minute
    setInterval(spawnGolden, GOLD_CHECK_INTERVAL);

    // also run spawn check on boot (so it could appear immediately sometimes)
    setTimeout(spawnGolden, 3000);

    // ---------- initial boot ----------
    renderUpgrades();
    updateUI();
    restartAutoLoop();

    // debug helper in console
    window._S = S;
  </script>
</body>
</html>
